<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .order-card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 25px;
        }
        .section-title {
            color: #0d6efd;
            border-bottom: 2px solid #0d6efd;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-weight: 600;
        }
        .back-arrow {
            cursor: pointer;
            transition: color 0.3s;
        }
        .back-arrow:hover {
            color: #0d6efd !important;
        }
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 300px;
        }
        .error-message {
            color: #dc3545;
            text-align: center;
            padding: 20px;
        }
        .table th {
            background-color: #f1f5fd;
        }
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                background-color: white;
                padding: 0;
            }
            .order-card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="order-card">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <span class="text-primary" style="font-weight: bold; font-size: 22px;">
                    <i class="fas fa-arrow-left me-2 back-arrow" style="color:black" onclick="history.back()"></i>
                    <span id="pod-no">Loading...</span>
                </span>
                <div class="no-print">
                    <button class="btn btn-primary" onclick="window.print()">
                        <i class="fas fa-print me-2"></i>Print
                    </button>
                </div>
            </div>

            <div id="order-content">
                <div class="loading-spinner">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API URL - replace with your actual API endpoint
        const API_URL = 'https://www.loginlogistics.in/main/driverapp/edit-order.php';
        
        // Sample data structure for reference
        const sampleData = {
            "result": "1",
            "ord_id": "MTU-",
            "consignor_name": "Stankara",
            "consignorId": "22791",
            "supp_inv_no": "s",
            "consignor_phone": "0212121212",
            "consignor_city": "Thrissur",
            "consignor_cityId": "22791",
            "consignor_address": "sddssc",
            "consignee_name": "dawi a/v cherani",
            "consigneeId": "35",
            "consignee_phone": "0212121212",
            "consignee_city": "Manjeri",
            "consignee_cityId": "104",
            "consignee_address": "sddssc",
            "payment_type": "toPay",
            "pod_no": "22791-222211112025202520252025/1",
            "box_small_qty": "5",
            "box_small_price": "55",
            "box_medium_qty": "0",
            "box_medium_price": "0",
            "box_large_qty": "0",
            "box_large_price": "0",
            "cover_small_qty": "5",
            "cover_small_price": "55",
            "cover_medium_qty": "0",
            "cover_medium_price": "0",
            "cover_large_qty": "0",
            "cover_large_price": "0",
            "route": "23",
            "route_name": "MANJERI"
        };

        // Function to fetch order data from API
        async function fetchOrderData() {
            try {
                // In a real scenario, you would get these values from your application
                const ord_id = "MTU-"; // Replace with actual order ID
                const app_id = "your_app_id"; // Replace with actual app ID
                
                // Create form data for POST request
                const formData = new FormData();
                formData.append('ord_id', ord_id);
                formData.append('app_id', app_id);
                
                // Make API request
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                const data = await response.json();
                
                // Display the data
                displayOrderData(data);
                
            } catch (error) {
                console.error('Error fetching order data:', error);
                // Display sample data for demonstration
                displayOrderData(sampleData);
                // In a real application, you would show an error message
                // document.getElementById('order-content').innerHTML = 
                //     '<div class="error-message">Failed to load order details. Please try again.</div>';
            }
        }

        // Function to display order data
        function displayOrderData(data) {
            // Update POD number
            document.getElementById('pod-no').textContent = `POD No: ${data.pod_no} Order Details`;
            
            // Generate HTML content
            const content = `
                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Warehouse</div>
                    <div class="col-md-8">LOG-IN LOGISTICS</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignor</div>
                    <div class="col-md-8">${data.consignor_name}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignor Phone</div>
                    <div class="col-md-8">${data.consignor_phone}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignor Inv no</div>
                    <div class="col-md-8">${data.supp_inv_no}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignor Address</div>
                    <div class="col-md-8">${data.consignor_address}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignor City</div>
                    <div class="col-md-8">${data.consignor_city}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Pickup Route</div>
                    <div class="col-md-8">${data.route_name}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignee</div>
                    <div class="col-md-8">${data.consignee_name}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignee Phone</div>
                    <div class="col-md-8">${data.consignee_phone}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignee Address</div>
                    <div class="col-md-8">${data.consignee_address}</div>
                </div>

                <div class="row mb-2">
                    <div class="col-md-4 fw-bold">Consignee City</div>
                    <div class="col-md-8">${data.consignee_city}</div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-4 fw-bold">Payment</div>
                    <div class="col-md-8">${data.payment_type}</div>
                </div>   
                
                <div class="row mb-3">
                    <div class="col-md-4 fw-bold">Notes</div>
                    <div class="col-md-8"></div> 
                </div>
            `;
            
            document.getElementById('order-content').innerHTML = content;
            
            // Add particulars section
            addParticularsSection(data);
        }

        // Function to add particulars section
        function addParticularsSection(data) {
            const particularsSection = document.createElement('div');
            particularsSection.className = 'order-card mt-4';
            
            // Calculate totals
            const totalQty = parseInt(data.box_small_qty) + parseInt(data.box_medium_qty) + 
                             parseInt(data.box_large_qty) + parseInt(data.cover_small_qty) + 
                             parseInt(data.cover_medium_qty) + parseInt(data.cover_large_qty);
            
            const totalAmount = (parseInt(data.box_small_qty) * parseFloat(data.box_small_price)) +
                              (parseInt(data.box_medium_qty) * parseFloat(data.box_medium_price)) +
                              (parseInt(data.box_large_qty) * parseFloat(data.box_large_price)) +
                              (parseInt(data.cover_small_qty) * parseFloat(data.cover_small_price)) +
                              (parseInt(data.cover_medium_qty) * parseFloat(data.cover_medium_price)) +
                              (parseInt(data.cover_large_qty) * parseFloat(data.cover_large_price));
            
            particularsSection.innerHTML = `
                <h5 class="section-title">Particulars</h5>
                
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Particular</th>
                            <th>Small</th>
                            <th>Medium</th>
                            <th>Large</th>
                            <th>X-Large</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Box</td>
                            <td>${data.box_small_qty}</td>
                            <td>${data.box_medium_qty}</td>
                            <td>${data.box_large_qty}</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>Packet</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>Cover</td>
                            <td>${data.cover_small_qty}</td>
                            <td>${data.cover_medium_qty}</td>
                            <td>${data.cover_large_qty}</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>Envelope</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="d-flex justify-content-end gap-3 mt-3">
                    <div class="fw-bold">Total Qty</div>
                    <div class="ms-3">${totalQty}</div>
                </div>
                
                <div class="d-flex justify-content-end gap-3 mt-2">
                    <div class="fw-bold">Total Amount</div>
                    <div class="ms-3">${totalAmount.toFixed(2)}</div>
                </div>
            `;
            
            document.querySelector('.container').appendChild(particularsSection);
        }

        // Initialize the page when it loads
        document.addEventListener('DOMContentLoaded', function() {
            fetchOrderData();
        });
    </script>
</body>
</html>